# 0. 後期中間報告書
   - **企画名:** M5Stackを用いた体温調節を促す健康管理の味方 "Staっち" の開発
  - **班番号:** RWC24-group15
  - **チーム名:** Health&Peace
  - **チームメンバー:**
    -   2312110253：田中　暖人
    -   2312110254：岩永　大輝
    -   2312110292：竹永　唯晟
    -   2312110113：生駒　涼太郎
    -   2312110008：森井　雄也

# 1. 後期役割分担

**プロジェクトリーダー**  
- 田中 暖人: プロジェクト全体の管理、各メンバー毎の進捗確認を担当しました。

**企画**  
- 生駒　涼太郎: 本プロジェクトの概要の整理及び実装システムの構造。またサブリーダーも兼ねるため、リーダーの業務について把握しつつ、リーダー欠席の際は代役を担当しました。

**UI・デザイン**  
- 竹永　唯晟: ユーザーインターフェースの設計・開発、M5Stackの環境センサーを用いたデータの視覚化の実装構想を担当しました。

**クライアント**
- 森井　雄也: センサーの接続、実装プログラム等のM5Stackに関する技術調査を担当しました。

**サーバーサイド**
- 岩永　大輝: サーバーサイドの設計・開発、データベース管理、APIの実装などセンサーから取得したデータの管理に関する処理等の調査を担当しました。


## 2.システムの概要
### システム名: 体温管理システム
### 対象ユーザー：・体調調整が苦手・できない人（特に高齢者を中心に）・健康管理に関心がある人・多忙な人
### システムの目的:現代社会では、多くの大学生や社会人が自分の健康を十分に管理できていません。特に20代から40代の世代では、「健康管理をしている」と回答する割合が高齢者と比較して圧倒的に少ないことが図1[^1]から分かります。

 ![image](https://github.com/user-attachments/assets/4d26c04f-057e-41c0-a46f-8ff0a48fa735)

*[図1　日常的な自分の健康管理（年代別）]*

また、若年層の健康管理意識の低さに加え、時間やコストがかかるという理由から、健康管理が敬遠される傾向があります。この課題を解決するため、手軽で簡単に健康管理ができるシステムの普及が求められています。
そこで、本プロジェクトでは、スマートフォンやM5Stackなどのコンパクトなデバイスを活用し、以下の特徴を持つシステムを提案します：

- 環境センサー（例：温度、湿度）から得られたデータを数値ではなく、視覚的にわかりやすい「表情」で表現。
- 直感的で使いやすいインターフェースを提供し、老若男女問わず誰でも利用可能。
- 夜間や急激な気温変化に迅速に気づけるため、高齢者や持病を持つ人々の健康維持に貢献。

これにより、日常生活に自然に取り入れられるシステムを目指します。
　　　　　　　　　
### 主要な機能

#### 1.	環境センサー（EnvⅢ Unit）による温度感知
- 温度や湿度などの環境データを検知。
#### 2.	データの視覚化
検知したデータに基づき、表情のGUIを表示。例：
- 通常時：にっこりとした穏やかな表情
- 高温感知時：「暑い」と判定し、汗をかいた苦しそうな表情
#### 3.	温度判定システム
- 環境センサーで得られたデータをUiFlow Desktop IDE内で処理。
- GAS Proxyを介してGoogle Apps Script (GAS) に送信し、温度を判定。
- 判定結果を再びM5Stackに戻し、表情を更新。
#### 4. リアルタイム監視
- 高齢者や持病を持つ人々に対し、急激な体調変化を監視。
- 適切なフィードバックを提供し、早期対応をサポート。
#### 5.	簡易的な操作
- 計測データは定期的に更新され、過去の記録は自動的に消去。
- ユーザーはデータ管理を行う必要がなく、日常生活に取り入れやすい設計。

以上のシステムにより、健康管理の意識向上と実践の簡便化を目指します。

# 3. 進捗状況

## 概要
この章では、添付のガントチャートをもとに各タスクの進捗状況について詳細に説明します。
以下にガントチャートを図2として示します。

<img width="1111" alt="スクリーンショット 2024-11-18 23 33 57" src="https://github.com/user-attachments/assets/d2dea45b-b5d6-40cb-845a-7a6a5cc825a9">

*[図２　後期中間報告までのガントチャートと各タスクの進捗]*

## 途中の作業の進捗状況

### プログラミングのサポート（進捗度：40%）
現在、個別のプログラムは概ね完成し、各機能が単独では正常に動作しています。しかし、これらを統合し、システム全体としてテストする段階には至っていません。特に、ネットワーク通信接続に関するタスクの遅延が統合作業に影響を及ぼしています。

具体的には、UiFlow上で生成されたリクエストをサーバー経由でGoogle Apps Script (GAS) に送信し、その判定結果をM5Stackへ戻すプロセスが未実装です。この通信部分が完了すれば、プログラム全体の統合とテストの実施が可能となるため、早急に解決すべき課題です。

### M5StackとGASの統合（進捗度：40%）

M5Stackのネットワーク通信、特にWiFi接続のテストが不十分であり、これがGAS Proxyを介したGASとの通信実装の進捗を阻害しています。
この課題は、ネットワーク接続に関する設定の確認や通信ログの詳細な調査を通じて解決可能と考えられます。WiFi接続が安定すれば、GASへのリクエスト送信および結果の受信がスムーズに進む見込みです。

## 完了したタスク（進捗度100%）

### 画像の出力機能

UiFlow Desktop IDE上に50KB以下の画像をアップロードし、M5Stackでの画像出力を実現しました。この機能により、任意の画像データをM5Stack上で表示可能となり、今後のデータ視覚化に向けた基盤が整備されています。

### 開発環境の構築

USBケーブルを用いてM5StackをUiFlow Desktop IDEに接続することで、開発環境を整えました。この準備により、プログラムのデプロイやテストが効率的に行える状態が整っています。

## 遅延しているタスク

### 値に応じた画像の動的切り替え（進捗度：10%）

現在、画像自体の出力は成功しているものの、環境センサーのデータ（例：温度や湿度）に基づく画像の切り替えが未実装です。この課題の主因は、技術調査の不足により、画像の切り替え方法が明確でなかったために多くの時間を費やしてしまったことにあります。
対策として、UiFlowのドキュメントや関連技術資料を改めて調査し、センサー値をトリガーとしてGUIを変更するロジックを早急に実装する必要があります。

### ネットワーク通信の実装（進捗度：0%）

GAS Proxyを用いたネットワーク通信は、システム全体の重要な基盤であるにも関わらず、WiFi接続テストの未完了により着手できていません。この遅延は、他タスクの優先度が高かったために後回しとなったことが主な原因です。
今後は、ネットワーク接続設定を優先的に進め、安定した通信環境を構築することで、GAS連携の実装に取り掛かる計画です。

## 今後の改善案

### 1.	タスクの優先順位見直し
　ネットワーク通信は他のタスクに依存する部分が多いため、最優先で対応する。
### 2.	技術調査の強化
　不足している技術情報（画像切り替え、ネットワーク通信）の確認を迅速に行う。
### 3.	定期的な進捗管理
　遅延リスクを早期に発見するため、進捗確認の頻度を上げる。

以上の計画を基に、スケジュールを再調整し、タスクの進捗を加速させることを目指します。

# 4. 課題とリスク管理

## 主要課題: ネットワーク通信が十分にテストできておらず、個々のシステムの統合に支障をきたす可能性

### リスク

#### 1.	GASとの通信が実現できない可能性
- ネットワーク接続が不安定、または接続設定の不備により、GAS Proxyを介した通信が動作しない可能性がある。
- サーバーとの双方向通信が確立しない場合、センサー値に基づく判定処理が行えなくなり、システム全体の機能が不完全になるリスクがある。
#### 2.	統合テストが間に合わない可能性
- ネットワーク通信の課題が解決しないままでは、個々の機能を統合したテストが実施できないため、最終的な動作確認ができない。
- 結果として、システムとしての完成度が低下し、ユーザーへの提供価値が損なわれる。

###解決策

#### 1. ネットワーク接続における優先タスクの再設定

- 現時点で進行中のタスクの中で、ネットワーク接続テストを最優先事項に位置づけ、早期解決を目指す。
- 必要に応じて、接続設定やログを詳細に分析し、問題点を特定・解消する。

#### 2. ローカルシステムでの代替構築

- 万が一、ネットワーク接続が確立できない場合は、以下のようにローカルシステムでの代替案を検討する：
- UiFlow Desktop IDE上で、判定処理を完結させるプログラムを開発する。センサー値を直接M5Stack内で処理し、画像表示に反映させる。
- GASを使用しないオフライン対応の機能を実装し、システムをスタンドアロンで運用可能にする。
- 判定ロジックの簡略化（例：センサー値に基づく閾値の直接設定）により、処理の複雑さを軽減する。

#### 3. スケジュールの柔軟な調整

- 統合テストのスケジュールを再検討し、ネットワーク接続完了後の短期間で実施可能なテスト項目を優先的にリストアップする。
- プログラムの個々の部分テスト（ユニットテスト）を先行して行い、統合時のトラブルを最小限に抑える。

### その他リスク管理の観点

#### 技術的課題の共有
チーム内で技術的な問題を共有し、解決策を協力して考える体制を整える。
#### バックアッププランの作成
最悪の場合を想定したバックアッププランを用意しておくことで、プロジェクト全体の進行に影響が出ることを防ぐ。

これらの対策を通じて、リスクの発生を最小限に抑え、プロジェクトの成功に向けた進行を目指します。


# 5. 参考リスト
[^1]:「NTTコム　健康管理に関する調査」 https://research.nttcoms.com/database/data/002165/

